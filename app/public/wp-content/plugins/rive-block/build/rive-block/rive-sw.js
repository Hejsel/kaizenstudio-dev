const CACHE_VERSION="rive-block-v1",CACHE_NAME=`${CACHE_VERSION}-assets`,STATIC_ASSETS=["/wp-content/plugins/rive-block/build/rive-block/webgl2_advanced.wasm","/wp-content/plugins/rive-block/build/rive-block/view.js"];self.addEventListener("install",e=>{console.log("[Rive SW] Installing Service Worker vrive-block-v1"),e.waitUntil(caches.open(CACHE_NAME).then(e=>(console.log("[Rive SW] Caching static assets"),e.addAll(STATIC_ASSETS))).then(()=>(console.log("[Rive SW] Static assets cached successfully"),self.skipWaiting())).catch(e=>{console.error("[Rive SW] Installation failed:",e)}))}),self.addEventListener("activate",e=>{console.log("[Rive SW] Activating Service Worker vrive-block-v1"),e.waitUntil(caches.keys().then(e=>Promise.all(e.filter(e=>e.startsWith("rive-block-")&&e!==CACHE_NAME).map(e=>(console.log("[Rive SW] Deleting old cache:",e),caches.delete(e))))).then(()=>(console.log("[Rive SW] Old caches cleaned up"),self.clients.claim())))}),self.addEventListener("fetch",e=>{const{request:t}=e,l=new URL(t.url);l.pathname.includes("/rive-block/")&&(l.pathname.endsWith(".wasm")||l.pathname.endsWith(".riv")||l.pathname.includes("/view.js"))&&e.respondWith(caches.match(t).then(e=>e?(console.log("[Rive SW] Serving from cache:",l.pathname),e):(console.log("[Rive SW] Fetching from network:",l.pathname),fetch(t).then(e=>{if(!e||200!==e.status)return e;const a=e.clone();return caches.open(CACHE_NAME).then(e=>{console.log("[Rive SW] Caching:",l.pathname),e.put(t,a)}),e}).catch(e=>{throw console.error("[Rive SW] Fetch failed:",l.pathname,e),e}))))}),self.addEventListener("message",e=>{e.data&&"SKIP_WAITING"===e.data.type&&(console.log("[Rive SW] Received SKIP_WAITING message"),self.skipWaiting()),e.data&&"CLEAR_CACHE"===e.data.type&&(console.log("[Rive SW] Clearing cache"),e.waitUntil(caches.delete(CACHE_NAME).then(()=>(console.log("[Rive SW] Cache cleared"),self.clients.matchAll())).then(e=>{e.forEach(e=>{e.postMessage({type:"CACHE_CLEARED"})})})))});